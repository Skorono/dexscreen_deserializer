import{bc as D,$,cq as E,b2 as P,cr as N,x,y as e,Z as v,cs as X,ct as I,b7 as z,ar as Y,aV as q,as as J,cu as O,at as Q,au as Z,ax as K,aw as ee,J as S,T as ne,V as te,a9 as w,cv as F,cw as se,cc as oe,M as re,A as m,cx as ae,cy as W,U as B,cz as ie,Q as ce,cA as T,cB as le,cC as de,bn as ue,cD as R,cE as he,bt as ge,cF as fe,cG as xe}from"../entries/pages_catch-all.FuUq_SWM.js";import{_ as be}from"./preload-helper-Jimfoxkq.js";import{B as pe}from"./index.esm-Iy9nVT7U.js";import{I as me,a as ve}from"./index.esm-F6wuoNhz.js";import{S as L}from"./span-PjwCQCyI.js";import{u as we}from"./upperFirst-ovMuif-N.js";function A(i){return we(D(i).toLowerCase())}const ye=$(N,P,(i,c)=>({actions:{create:async o=>{const u=await E(c.ensuredCurrentUser);i.create(u.id,{schemaVersion:o.schemaVersion,provider:o.provider,token:o.token})},delete:async o=>i.delete(o)}})),Ce=({onClick:i,message:c})=>{const[o,u]=x.useState(!1),r=x.useCallback(()=>{const f=document.createElement("link");f.href="https://fonts.googleapis.com/css?family=Roboto:400,400i,500,700&display=swap",f.rel="stylesheet",f.onload=()=>u(!0),document.head.appendChild(f),u(!0)},[]);return x.useEffect(()=>{o||r()},[o,r]),e.jsx(v,{onClick:i,display:"flex",alignItems:"center",color:"white",justifyContent:"center",fontFamily:o?"Roboto":"sans-serif",fontWeight:"bold",cursor:"pointer",outline:"none",backgroundColor:"#4285F4",boxShadow:"0px 2px 3px rgba(0, 0, 0, 0.2)",height:"38px",width:"240px",leftIcon:e.jsx(X,{size:14}),_hover:{opacity:"0.8"},children:c})},Se=i=>{let c={title:"",header:""};return i&&i.isAuthenticated?c={title:"My account",header:""}:c={title:"Sign-in",header:"Sign-in to DEX Screener to sync your settings, lists and alerts accross unlimited devices."},{texts:c}},ke=re(()=>be(()=>import("./connect-rainbowkit-button-TeR_Q2v-.js").then(i=>i.a_),__vite__mapDeps([0,1,2,3,4,5]))),je=({onClose:i,handleProviderLogout:c,handleProviderLogin:o})=>{const u=m(P),r=I(()=>u.authData,[u.authData]),f=z("black","white"),y=z("white","black");return e.jsxs(Y,{size:"lg",onClose:i,motionPreset:"none",blockScrollOnMount:!1,isOpen:!0,isCentered:q({base:!1,md:!0}),children:[e.jsx(J,{sx:{zIndex:50}}),O({value:r,onPending:()=>null,onFailure:()=>null,onSuccess:l=>{const{texts:t}=Se(l);return e.jsxs(Q,{sx:{zIndex:50,minHeight:l.isAuthenticated?320:370},children:[e.jsx(Z,{}),e.jsxs(K,{py:5,px:0,textAlign:"center",children:[e.jsx(ee,{children:t.title}),e.jsxs(S,{mt:2,p:5,children:[!!t.header&&e.jsx(ne,{mb:10,fontSize:"md",children:t.header}),e.jsxs(te,{mt:5,spacing:l.isAuthenticated?5:3,display:"flex",justifyContent:"center",children:[!l.allProvidersConnected&&!l.googleProvider?e.jsx(Ce,{onClick:()=>o("google"),message:"Sign in with Google"}):e.jsx(v,{height:"38px",width:"240px",leftIcon:e.jsx(w,{as:F,color:"green.300"}),borderColor:"green.300",borderWidth:1,onClick:c,fontWeight:"normal",children:"Signed in with Google"}),!l.allProvidersConnected&&!l.appleProvider?e.jsx(v,{height:"38px",width:"240px",leftIcon:e.jsx(w,{as:se,color:y,height:"18px",marginBottom:"2px"}),backgroundColor:f,color:y,onClick:()=>o("apple"),fontFamily:"system-ui",fontWeight:"bold",_hover:{opacity:.8},children:"Sign in with Apple"}):e.jsx(v,{height:"38px",width:"240px",leftIcon:e.jsx(w,{as:F,color:"green.300"}),borderColor:"green.300",borderWidth:1,onClick:c,_hover:{opacity:.8},fontWeight:"normal",children:"Signed in with Apple"}),!l.allProvidersConnected&&!l.web3walletProvider?e.jsx(x.Suspense,{fallback:e.jsx(v,{width:"240px",height:"38px",isDisabled:!0,children:e.jsx(oe,{})}),children:e.jsx(ke,{})}):e.jsx(v,{height:"38px",width:"240px",leftIcon:e.jsx(w,{as:F,color:"green.300"}),borderColor:"green.300",borderWidth:1,onClick:c,fontWeight:"normal",children:"Wallet Connected"})]})]})]})]})}})]})},Ae=x.memo(i=>{const{loading:c,onSignIn:o,onSignOut:u}=i,r=m(P),f=I(()=>r.authData,[r.authData]),y=I(()=>r.currentUser,[r.currentUser]);return O({value:ae(y,f,(l,t)=>({currentUser:l,authData:t})),onPending:()=>null,onFailure:()=>null,onSuccess:({currentUser:l,authData:t})=>{const k=t.allProvidersConnected?u:o,b=t.isAnonymous?v:S;return e.jsxs(b,{fontWeight:"normal",bg:"blue.1000",fontSize:{base:"lg",lg:"inherit"},_focus:{boxShadow:"none",bg:"blue.950"},paddingLeft:{base:2,lg:3},variant:"unstyled",display:"flex",width:"100%",borderRadius:0,color:"white",onClick:t.isAnonymous?k:()=>null,sx:t.isAnonymous?{"@media(hover: hover)":{_hover:{bg:"blue.950"}}}:void 0,height:"auto",justifyContent:"space-between",borderTopWidth:{base:0,lg:"1px"},borderBottomWidth:{base:"1px",lg:0},borderColor:"blue.950",children:[e.jsx(W,{isDisabled:!l,label:t.username,children:e.jsxs(B,{spacing:1,marginEnd:l?0:1,overflow:"hidden",px:{base:1,lg:0},py:{base:3,lg:"10px"},children:[e.jsx(w,{as:ie,boxSize:"18px"}),e.jsx(L,{fontSize:"md",noOfLines:1,cursor:"default",children:t.username})]})}),e.jsxs(S,{display:"flex",fontWeight:"semibold",_focus:{boxShadow:"none"},children:[!t.isAnonymous&&!c&&e.jsx(S,{children:e.jsx(W,{isDisabled:!t.allProvidersConnected,label:"Sign out",children:e.jsx(v,{onClick:k,variant:"ghost",height:"100%",borderRadius:0,width:"auto",paddingLeft:2,paddingRight:2,iconSpacing:1,lineHeight:"1",fontSize:"xs",color:"blue.600",_focus:{bg:"blue.950",color:"white",boxShadow:"none"},sx:{"@media(hover: hover)":{_hover:{bg:"blue.950",color:"white"}}},children:t.allProvidersConnected?e.jsx(w,{as:me,boxSize:"16px"}):e.jsx(w,{as:ve,boxSize:"16px"})})})}),t.isAnonymous&&!c&&e.jsxs(B,{marginX:2,spacing:1,children:[e.jsx(w,{as:pe,boxSize:"16px"}),e.jsx(L,{fontSize:"xs",children:"Sign-in"})]})]})]})}})}),Me=x.memo(()=>{const i=m(ye),c=m(he),o=m(P),u=m(ue),r=m(ge),f=ce(),y=m(fe),[l,t]=x.useState(!1),k=I(()=>o.authData,[o.authData]),b=O({value:k,onFailure:()=>T,onPending:()=>T,onSuccess:n=>n});x.useEffect(()=>{b.isAuthenticated&&t(!1)},[b]);const g=x.useCallback((n,a,p)=>{if(!a)return;const U={signIn:{success:`You were successfully signed in with ${A(p)}.`,error:`Failed to sign in with ${A(p)}, try again.`},signOut:{success:"You were successfully signed out.",error:"Failed to sign out, try again."},link:{success:"Account linked successfully!",error:`Failed to link to your ${A(p)} account, try again.`},inUse:{success:"",error:`There's an account already linked to this ${A(p)} email.`}};f({status:a,title:U[n][a],isClosable:!0})},[f]),V=x.useCallback(()=>{t(!0),u.track({event:"user:login-initiated"})},[u]),_=x.useCallback(async()=>{g("signOut","success"),await E(o.signOut()),t(!1),u.track({event:"user:logout"})},[o,u,g]),M=new le,C=new de("apple.com");C.addScope("email"),C.addScope("name"),C.setCustomParameters({locale:"en"});const H=async n=>{const a=await y();if(!a.currentUser)return;const p=n==="google"?M:C;switch(n){case"google":{const d=a.currentUser.providerData.find(s=>s.providerId==="google.com");if(!(b!=null&&b.googleProvider)&&d){await i.actions.create({schemaVersion:"1.0.0",provider:n,token:d.uid}).catch(s=>{r.error({id:"failedCreatingAuthProviderOnFallbackMethod",data:{provider:n,error:s}}),g("link","error",n)});return}break}case"apple":{const d=a.currentUser.providerData.find(s=>s.providerId==="apple.com");!(b!=null&&b.appleProvider)&&d&&await i.actions.create({schemaVersion:"1.0.0",provider:n,token:d.uid}).catch(s=>{r.error({id:"failedCreatingAuthProviderOnFallbackMethod",data:{provider:n,error:s}}),g("link","error",n)})}break}const j=await(await c()).httpsCallable("authenticateAuthProvider");xe(a.currentUser,p).then(async d=>{var s;if(!d.providerId){r.error({event:{id:"emptyProviderId",data:{userId:(s=a.currentUser)==null?void 0:s.uid,result:d}}}),g("link","error",n);return}if(d.user.providerData[0]){const h=await j({provider:n,token:d.user.providerData[0].uid});h.data.success||(r.error({event:{id:"failedOnCallingAuthenticateUserFunction",data:{error:h.data.error}}}),g("link","error",n))}g("link","success",n),t(!1)}).catch(d=>{var s;d.code==="auth/credential-already-in-use"&&g("inUse","error",n),r.error({event:{id:"failedAddingProviderToUser",data:{provider:n,error:d,userId:(s=a.currentUser)==null?void 0:s.uid}}})})},G=async n=>{var d;const a=await y();if(a.currentUser&&!a.currentUser.isAnonymous)return H(n);const p=(d=a.currentUser)!=null&&d.isAnonymous?a.currentUser.uid:void 0,j=await(await c()).httpsCallable("authenticateAuthProvider");switch(n){case"google":{await R(a,M).then(async s=>{if(s.user.providerData[0]){const h=await j({anonymousUserId:p,provider:n,token:s.user.providerData[0].uid});h.data.success||r.error({event:{id:"failedOnCallingAuthenticateUserFunction",data:{error:h.data.error}}})}g("signIn","success",n),t(!1)}).catch(s=>{var h;r.error({event:{id:"failedHandlingProviderLogin",data:{provider:n,error:s,userId:(h=a.currentUser)==null?void 0:h.uid}}}),g("signIn","error",n)});break}case"apple":{await R(a,C).then(async s=>{if(s.user.providerData[0]){const h=await j({anonymousUserId:p,provider:n,token:s.user.providerData[0].uid});h.data.success||r.error({event:{id:"failedOnCallingAuthenticateUserFunction",data:{error:h.data.error}}})}g("signIn","success",n),t(!1)}).catch(s=>{var h;r.error({event:{id:"failedHandlingProviderLogin",data:{provider:n,error:s,userId:(h=a.currentUser)==null?void 0:h.uid}}}),g("signIn","error",n)});break}}};return e.jsxs(S,{textAlign:"center",justifyContent:"space-between",width:"100%",children:[e.jsx(Ae,{loading:l,onSignIn:V,onSignOut:_}),l&&e.jsx(je,{onClose:()=>t(!1),handleProviderLogout:_,handleProviderLogin:G})]})});export{Me as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/chunks/connect-rainbowkit-button-TeR_Q2v-.js","assets/entries/pages_catch-all.FuUq_SWM.js","assets/chunks/preload-helper-Jimfoxkq.js","assets/static/catch-all.Yj8n6pm8.css","assets/chunks/delayed-N7hotTnG.js","assets/static/connect-rainbowkit-button.39BX3rkw.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
